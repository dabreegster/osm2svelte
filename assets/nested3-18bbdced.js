import{S as H,i as K,s as Q,a1 as V,h as T,j as B,n as j,m as N,e as X,u as G,a as b,x as q,t as v,b as O,y as L,d as w,D as U,E as z,a2 as A,a3 as Y,k as F,C as Z,l as P,o as C,q as J,w as W,L as x,K as ee,M as te,W as re,N as se,O as ne,P as ie,g as oe,c as le,Q as ae,R as fe,T as pe,U as ue,V as me}from"./SelectImportArea-8248d6fd.js";import{O as _e}from"./Osm2streetsSettings-cf212ea8.js";function ge(n){const e=n.slice(),r=e[0]||e[1];return e[8]=r,e}function $e(n){let e;return{c(){e=F("p"),e.textContent="Hover on a road to see its details"},m(r,t){b(r,e,t)},p:Z,d(r){r&&w(e)}}}function E(n){let e,r,t,s,i=n[8].properties.osm_id+"",a,k,h,$,c,_=n[8].properties.weight+"",u,y,o,p,d,M=JSON.stringify(JSON.parse(n[8].properties.osm_tags),null,"  ")+"",I,g,f,S=JSON.stringify(JSON.parse(n[8].properties.lane_specs_ltr),null,"  ")+"",R;return{c(){e=F("br"),r=N(),t=F("a"),s=P("Open OSM way "),a=P(i),h=N(),$=F("br"),c=P(`
  Weight: `),u=P(_),y=N(),o=F("br"),p=P(`
  Tags:
  `),d=F("pre"),I=P(M),g=P(`
  Lanes:
  `),f=F("pre"),R=P(S),C(t,"href",k=`http://openstreetmap.org/way/${n[8].properties.osm_id}`),C(t,"target","_blank"),C(t,"rel","noreferrer"),C(d,"class","svelte-y0uczf"),C(f,"class","svelte-y0uczf")},m(l,m){b(l,e,m),b(l,r,m),b(l,t,m),J(t,s),J(t,a),b(l,h,m),b(l,$,m),b(l,c,m),b(l,u,m),b(l,y,m),b(l,o,m),b(l,p,m),b(l,d,m),J(d,I),b(l,g,m),b(l,f,m),J(f,R)},p(l,m){m&3&&i!==(i=l[8].properties.osm_id+"")&&W(a,i),m&3&&k!==(k=`http://openstreetmap.org/way/${l[8].properties.osm_id}`)&&C(t,"href",k),m&3&&_!==(_=l[8].properties.weight+"")&&W(u,_),m&3&&M!==(M=JSON.stringify(JSON.parse(l[8].properties.osm_tags),null,"  ")+"")&&W(I,M),m&3&&S!==(S=JSON.stringify(JSON.parse(l[8].properties.lane_specs_ltr),null,"  ")+"")&&W(R,S)},d(l){l&&w(e),l&&w(r),l&&w(t),l&&w(h),l&&w($),l&&w(c),l&&w(u),l&&w(y),l&&w(o),l&&w(p),l&&w(d),l&&w(g),l&&w(f)}}}function ce(n){let e,r,t,s,i,a;function k(o){n[4](o)}function h(o){n[5](o)}let $={source:"road-weights",gj:n[2],layerStyle:n[3],interactive:!0};n[0]!==void 0&&($.clickedFeature=n[0]),n[1]!==void 0&&($.hoveredFeature=n[1]),e=new V({props:$}),T.push(()=>B(e,"clickedFeature",k)),T.push(()=>B(e,"hoveredFeature",h));function c(o,p){return o[0]||o[1]?E:$e}function _(o,p){return p===E?ge(o):o}let u=c(n),y=u(_(n,u));return{c(){j(e.$$.fragment),s=N(),y.c(),i=X()},m(o,p){G(e,o,p),b(o,s,p),y.m(o,p),b(o,i,p),a=!0},p(o,[p]){const d={};p&4&&(d.gj=o[2]),!r&&p&1&&(r=!0,d.clickedFeature=o[0],q(()=>r=!1)),!t&&p&2&&(t=!0,d.hoveredFeature=o[1],q(()=>t=!1)),e.$set(d),u===(u=c(o))&&y?y.p(_(o,u),p):(y.d(1),y=u(_(o,u)),y&&(y.c(),y.m(i.parentNode,i)))},i(o){a||(v(e.$$.fragment,o),a=!0)},o(o){O(e.$$.fragment,o),a=!1},d(o){L(e,o),o&&w(s),y.d(o),o&&w(i)}}}function de(n){return n.highway_type=="primary"?.8:.3}function ye(n,e,r){let t;U(n,z,_=>r(6,t=_));let s,i,a=A(),k={type:"fill",paint:{"fill-color":["interpolate",["linear"],["get","weight"],0,"blue",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],"fill-opacity":Y("hover",.8,.4)}};function h(){let _=A();if(!t)return _;let u=JSON.parse(t.toGeojsonPlain()),y=JSON.parse(t.toJson());for(let[o,p]of y.roads){let d={highway_type:p.highway_type,lane_specs_ltr:p.lane_specs_ltr,osm_id:void 0,osm_tags:{},weight:0};p.osm_ids.length==1&&(d.osm_id=p.osm_ids[0],d.osm_tags=JSON.parse(t.getOsmTagsForWay(BigInt(d.osm_id)))),d.weight=de(d),_.features.push({type:"Feature",properties:d,geometry:u.features.find(M=>o==M.properties.id).geometry})}return _}function $(_){s=_,r(0,s)}function c(_){i=_,r(1,i)}return r(2,a=h()),[s,i,a,k,$,c]}class be extends H{constructor(e){super(),K(this,e,ye,ce,Q,{})}}function D(n){let e,r;return e=new be({}),{c(){j(e.$$.fragment)},m(t,s){G(e,t,s),r=!0},i(t){r||(v(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){L(e,t)}}}function we(n){let e,r,t,s,i,a,k,h,$,c,_,u,y,o;s=new se({});function p(f){n[5](f)}let d={};n[1]!==void 0&&(d.settings=n[1]),a=new _e({props:d}),T.push(()=>B(a,"settings",p));function M(f){n[6](f)}let I={settings:n[1]};n[0]!==void 0&&(I.imported=n[0]),$=new ne({props:I}),T.push(()=>B($,"imported",M)),u=new ie({props:{imported:n[0]}});let g=n[3]&&D();return{c(){e=F("div"),r=F("h1"),r.textContent="osm2streets route profile tool",t=N(),j(s.$$.fragment),i=N(),j(a.$$.fragment),h=N(),j($.$$.fragment),_=N(),j(u.$$.fragment),y=N(),g&&g.c(),C(e,"slot","left")},m(f,S){b(f,e,S),J(e,r),J(e,t),G(s,e,null),J(e,i),G(a,e,null),J(e,h),G($,e,null),J(e,_),G(u,e,null),J(e,y),g&&g.m(e,null),o=!0},p(f,S){const R={};!k&&S&2&&(k=!0,R.settings=f[1],q(()=>k=!1)),a.$set(R);const l={};S&2&&(l.settings=f[1]),!c&&S&1&&(c=!0,l.imported=f[0],q(()=>c=!1)),$.$set(l);const m={};S&1&&(m.imported=f[0]),u.$set(m),f[3]?g?S&8&&v(g,1):(g=D(),g.c(),v(g,1),g.m(e,null)):g&&(oe(),O(g,1,1,()=>{g=null}),le())},i(f){o||(v(s.$$.fragment,f),v(a.$$.fragment,f),v($.$$.fragment,f),v(u.$$.fragment,f),v(g),o=!0)},o(f){O(s.$$.fragment,f),O(a.$$.fragment,f),O($.$$.fragment,f),O(u.$$.fragment,f),O(g),o=!1},d(f){f&&w(e),L(s),L(a),L($),L(u),g&&g.d()}}}function ke(n){let e,r,t,s;return e=new ue({}),e.$on("polygon",n[4]),t=new me({props:{layers:n[2]}}),{c(){j(e.$$.fragment),r=N(),j(t.$$.fragment)},m(i,a){G(e,i,a),b(i,r,a),G(t,i,a),s=!0},p(i,a){const k={};a&4&&(k.layers=i[2]),t.$set(k)},i(i){s||(v(e.$$.fragment,i),v(t.$$.fragment,i),s=!0)},o(i){O(e.$$.fragment,i),O(t.$$.fragment,i),s=!1},d(i){L(e,i),i&&w(r),L(t,i)}}}function ve(n){let e,r,t;return r=new ae({props:{$$slots:{default:[ke]},$$scope:{ctx:n}}}),{c(){e=F("div"),j(r.$$.fragment),C(e,"slot","main")},m(s,i){b(s,e,i),G(r,e,null),t=!0},p(s,i){const a={};i&135&&(a.$$scope={dirty:i,ctx:s}),r.$set(a)},i(s){t||(v(r.$$.fragment,s),t=!0)},o(s){O(r.$$.fragment,s),t=!1},d(s){s&&w(e),L(r)}}}function he(n){let e,r;return e=new x({props:{$$slots:{main:[ve],left:[we]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment)},m(t,s){G(e,t,s),r=!0},p(t,[s]){const i={};s&143&&(i.$$scope={dirty:s,ctx:t}),e.$set(i)},i(t){r||(v(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){L(e,t)}}}function Se(n,e,r){let t;U(n,z,c=>r(3,t=c));let s={kind:"nothing"},i,a=[];ee(async()=>{await fe()});const k=c=>pe(c,s,i);function h(c){i=c,r(1,i)}function $(c){s=c,r(0,s)}return n.$$.update=()=>{n.$$.dirty&1&&s.kind=="done"&&(z.set(s.network),te.set(s.boundaryGJ),r(2,a=re(s.network,s.boundaryGJ)))},[s,i,a,t,k,h,$]}class Oe extends H{constructor(e){super(),K(this,e,Se,he,Q,{})}}new Oe({target:document.getElementById("app")});

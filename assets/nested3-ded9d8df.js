import{S as E,i as D,s as K,b as z,a as q,d as J,c as F,H as V,m as j,e as _,j as A,t as v,f as S,k as m,l as M,n as Q,o as b,v as X,p as O,q as N,r as h,z as T,L as Y,C as Z,g as x,h as ee}from"./OverpassSelector-e2a07632.js";import{a as te,n as U,g as B,j as re,A as ne,I as se,M as le,i as oe,e as ae}from"./MainLayers-0fc5cab7.js";import{T as ie}from"./TopLeftPanel-d416be58.js";function ue(l){const e=l.slice(),r=e[0]||e[1];return e[8]=r,e}function fe(l){let e;return{c(){e=b("p"),e.textContent="Hover on a road to see its details"},m(r,t){_(r,e,t)},p:X,d(r){r&&m(e)}}}function G(l){let e,r,t,s,a=l[8].properties.osm_id+"",$,w,g,y,k,u=l[8].properties.weight+"",p,o,n,i,d,L=JSON.stringify(JSON.parse(l[8].properties.osm_tags),null,"  ")+"",I,R,C,P=JSON.stringify(JSON.parse(l[8].properties.lane_specs_ltr),null,"  ")+"",W;return{c(){e=b("br"),r=F(),t=b("a"),s=O("Open OSM way "),$=O(a),g=F(),y=b("br"),k=O(`
  Weight: `),p=O(u),o=F(),n=b("br"),i=O(`
  Tags:
  `),d=b("pre"),I=O(L),R=O(`
  Lanes:
  `),C=b("pre"),W=O(P),N(t,"href",w=`http://openstreetmap.org/way/${l[8].properties.osm_id}`),N(t,"target","_blank"),N(t,"rel","noreferrer"),N(d,"class","svelte-y0uczf"),N(C,"class","svelte-y0uczf")},m(f,c){_(f,e,c),_(f,r,c),_(f,t,c),h(t,s),h(t,$),_(f,g,c),_(f,y,c),_(f,k,c),_(f,p,c),_(f,o,c),_(f,n,c),_(f,i,c),_(f,d,c),h(d,I),_(f,R,c),_(f,C,c),h(C,W)},p(f,c){c&3&&a!==(a=f[8].properties.osm_id+"")&&T($,a),c&3&&w!==(w=`http://openstreetmap.org/way/${f[8].properties.osm_id}`)&&N(t,"href",w),c&3&&u!==(u=f[8].properties.weight+"")&&T(p,u),c&3&&L!==(L=JSON.stringify(JSON.parse(f[8].properties.osm_tags),null,"  ")+"")&&T(I,L),c&3&&P!==(P=JSON.stringify(JSON.parse(f[8].properties.lane_specs_ltr),null,"  ")+"")&&T(W,P)},d(f){f&&(m(e),m(r),m(t),m(g),m(y),m(k),m(p),m(o),m(n),m(i),m(d),m(R),m(C))}}}function pe(l){let e,r,t,s,a,$;function w(n){l[4](n)}function g(n){l[5](n)}let y={source:"road-weights",gj:l[2],layerStyle:l[3],interactive:!0};l[0]!==void 0&&(y.clickedFeature=l[0]),l[1]!==void 0&&(y.hoveredFeature=l[1]),e=new te({props:y}),z.push(()=>q(e,"clickedFeature",w)),z.push(()=>q(e,"hoveredFeature",g));function k(n,i){return n[0]||n[1]?G:fe}function u(n,i){return i===G?ue(n):n}let p=k(l),o=p(u(l,p));return{c(){J(e.$$.fragment),s=F(),o.c(),a=V()},m(n,i){j(e,n,i),_(n,s,i),o.m(n,i),_(n,a,i),$=!0},p(n,[i]){const d={};i&4&&(d.gj=n[2]),!r&&i&1&&(r=!0,d.clickedFeature=n[0],A(()=>r=!1)),!t&&i&2&&(t=!0,d.hoveredFeature=n[1],A(()=>t=!1)),e.$set(d),p===(p=k(n))&&o?o.p(u(n,p),i):(o.d(1),o=p(u(n,p)),o&&(o.c(),o.m(a.parentNode,a)))},i(n){$||(v(e.$$.fragment,n),$=!0)},o(n){S(e.$$.fragment,n),$=!1},d(n){n&&(m(s),m(a)),M(e,n),o.d(n)}}}function ce(l){return l.highway_type=="primary"?.8:.3}function _e(l,e,r){let t;Q(l,U,u=>r(6,t=u));let s,a,$=B(),w={type:"fill",paint:{"fill-color":["interpolate",["linear"],["get","weight"],0,"blue",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],"fill-opacity":re("hover",.8,.4)}};function g(){let u=B();if(!t)return u;let p=JSON.parse(t.toGeojsonPlain()),o=JSON.parse(t.toJson());for(let[n,i]of o.roads){let d={highway_type:i.highway_type,lane_specs_ltr:i.lane_specs_ltr,osm_id:void 0,osm_tags:{},weight:0};i.osm_ids.length==1&&(d.osm_id=i.osm_ids[0],d.osm_tags=JSON.parse(t.getOsmTagsForWay(BigInt(d.osm_id)))),d.weight=ce(d),u.features.push({type:"Feature",properties:d,geometry:p.features.find(L=>n==L.properties.id).geometry})}return u}function y(u){s=u,r(0,s)}function k(u){a=u,r(1,a)}return r(2,$=g()),[s,a,$,w,y,k]}class me extends E{constructor(e){super(),D(this,e,_e,pe,K,{})}}function H(l){let e,r;return e=new me({}),{c(){J(e.$$.fragment)},m(t,s){j(e,t,s),r=!0},i(t){r||(v(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function $e(l){let e,r,t,s,a,$,w,g,y,k,u,p;s=new ne({}),g=new se({});let o=l[0]&&H();return{c(){e=b("div"),r=b("h1"),r.textContent="osm2streets route profile tool",t=F(),J(s.$$.fragment),a=F(),$=b("hr"),w=F(),J(g.$$.fragment),y=F(),k=b("hr"),u=F(),o&&o.c(),N(e,"slot","left")},m(n,i){_(n,e,i),h(e,r),h(e,t),j(s,e,null),h(e,a),h(e,$),h(e,w),j(g,e,null),h(e,y),h(e,k),h(e,u),o&&o.m(e,null),p=!0},p(n,i){n[0]?o?i&1&&v(o,1):(o=H(),o.c(),v(o,1),o.m(e,null)):o&&(x(),S(o,1,1,()=>{o=null}),ee())},i(n){p||(v(s.$$.fragment,n),v(g.$$.fragment,n),v(o),p=!0)},o(n){S(s.$$.fragment,n),S(g.$$.fragment,n),S(o),p=!1},d(n){n&&m(e),M(s),M(g),o&&o.d()}}}function de(l){let e,r;return e=new ae({}),{c(){J(e.$$.fragment)},m(t,s){j(e,t,s),r=!0},i(t){r||(v(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ge(l){let e,r;return e=new ie({props:{$$slots:{default:[de]},$$scope:{ctx:l}}}),{c(){J(e.$$.fragment)},m(t,s){j(e,t,s),r=!0},p(t,s){const a={};s&2&&(a.$$scope={dirty:s,ctx:t}),e.$set(a)},i(t){r||(v(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ye(l){let e,r,t;return r=new le({props:{$$slots:{default:[ge]},$$scope:{ctx:l}}}),{c(){e=b("div"),J(r.$$.fragment),N(e,"slot","main")},m(s,a){_(s,e,a),j(r,e,null),t=!0},p(s,a){const $={};a&2&&($.$$scope={dirty:a,ctx:s}),r.$set($)},i(s){t||(v(r.$$.fragment,s),t=!0)},o(s){S(r.$$.fragment,s),t=!1},d(s){s&&m(e),M(r)}}}function he(l){let e,r;return e=new Y({props:{$$slots:{main:[ye],left:[$e]},$$scope:{ctx:l}}}),{c(){J(e.$$.fragment)},m(t,s){j(e,t,s),r=!0},p(t,[s]){const a={};s&3&&(a.$$scope={dirty:s,ctx:t}),e.$set(a)},i(t){r||(v(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function be(l,e,r){let t;return Q(l,U,s=>r(0,t=s)),Z(async()=>{await oe()}),[t]}class we extends E{constructor(e){super(),D(this,e,be,he,K,{})}}new we({target:document.getElementById("app")});

import{S as D,i as K,s as Q,h as W,j as A,n as j,m as N,e as V,u as L,a as b,x as T,t as k,b as F,d as h,y as G,E as U,k as O,D as X,l as M,o as P,q as J,w as R,L as Y,H as Z,g as x,c as ee}from"./maplibre-gl-d0269db5.js";import{k as te,n as q,l as z,o as re,b as se,f as ne,A as oe,B as ie,I as le,M as ae,i as pe,d as ue,S as fe,L as me}from"./SelectImportArea-7b14db0e.js";import{O as _e}from"./Osm2streetsSettings-37090808.js";function ge(n){const e=n.slice(),r=e[0]||e[1];return e[8]=r,e}function ce(n){let e;return{c(){e=O("p"),e.textContent="Hover on a road to see its details"},m(r,t){b(r,e,t)},p:X,d(r){r&&h(e)}}}function E(n){let e,r,t,s,o=n[8].properties.osm_id+"",l,w,v,c,d,_=n[8].properties.weight+"",f,y,i,u,$,I=JSON.stringify(JSON.parse(n[8].properties.osm_tags),null,"  ")+"",B,g,a,S=JSON.stringify(JSON.parse(n[8].properties.lane_specs_ltr),null,"  ")+"",C;return{c(){e=O("br"),r=N(),t=O("a"),s=M("Open OSM way "),l=M(o),v=N(),c=O("br"),d=M(`
  Weight: `),f=M(_),y=N(),i=O("br"),u=M(`
  Tags:
  `),$=O("pre"),B=M(I),g=M(`
  Lanes:
  `),a=O("pre"),C=M(S),P(t,"href",w=`http://openstreetmap.org/way/${n[8].properties.osm_id}`),P(t,"target","_blank"),P(t,"rel","noreferrer"),P($,"class","svelte-y0uczf"),P(a,"class","svelte-y0uczf")},m(p,m){b(p,e,m),b(p,r,m),b(p,t,m),J(t,s),J(t,l),b(p,v,m),b(p,c,m),b(p,d,m),b(p,f,m),b(p,y,m),b(p,i,m),b(p,u,m),b(p,$,m),J($,B),b(p,g,m),b(p,a,m),J(a,C)},p(p,m){m&3&&o!==(o=p[8].properties.osm_id+"")&&R(l,o),m&3&&w!==(w=`http://openstreetmap.org/way/${p[8].properties.osm_id}`)&&P(t,"href",w),m&3&&_!==(_=p[8].properties.weight+"")&&R(f,_),m&3&&I!==(I=JSON.stringify(JSON.parse(p[8].properties.osm_tags),null,"  ")+"")&&R(B,I),m&3&&S!==(S=JSON.stringify(JSON.parse(p[8].properties.lane_specs_ltr),null,"  ")+"")&&R(C,S)},d(p){p&&(h(e),h(r),h(t),h(v),h(c),h(d),h(f),h(y),h(i),h(u),h($),h(g),h(a))}}}function de(n){let e,r,t,s,o,l;function w(i){n[4](i)}function v(i){n[5](i)}let c={source:"road-weights",gj:n[2],layerStyle:n[3],interactive:!0};n[0]!==void 0&&(c.clickedFeature=n[0]),n[1]!==void 0&&(c.hoveredFeature=n[1]),e=new te({props:c}),W.push(()=>A(e,"clickedFeature",w)),W.push(()=>A(e,"hoveredFeature",v));function d(i,u){return i[0]||i[1]?E:ce}function _(i,u){return u===E?ge(i):i}let f=d(n),y=f(_(n,f));return{c(){j(e.$$.fragment),s=N(),y.c(),o=V()},m(i,u){L(e,i,u),b(i,s,u),y.m(i,u),b(i,o,u),l=!0},p(i,[u]){const $={};u&4&&($.gj=i[2]),!r&&u&1&&(r=!0,$.clickedFeature=i[0],T(()=>r=!1)),!t&&u&2&&(t=!0,$.hoveredFeature=i[1],T(()=>t=!1)),e.$set($),f===(f=d(i))&&y?y.p(_(i,f),u):(y.d(1),y=f(_(i,f)),y&&(y.c(),y.m(o.parentNode,o)))},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){F(e.$$.fragment,i),l=!1},d(i){i&&(h(s),h(o)),G(e,i),y.d(i)}}}function $e(n){return n.highway_type=="primary"?.8:.3}function ye(n,e,r){let t;U(n,q,_=>r(6,t=_));let s,o,l=z(),w={type:"fill",paint:{"fill-color":["interpolate",["linear"],["get","weight"],0,"blue",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],"fill-opacity":re("hover",.8,.4)}};function v(){let _=z();if(!t)return _;let f=JSON.parse(t.toGeojsonPlain()),y=JSON.parse(t.toJson());for(let[i,u]of y.roads){let $={highway_type:u.highway_type,lane_specs_ltr:u.lane_specs_ltr,osm_id:void 0,osm_tags:{},weight:0};u.osm_ids.length==1&&($.osm_id=u.osm_ids[0],$.osm_tags=JSON.parse(t.getOsmTagsForWay(BigInt($.osm_id)))),$.weight=$e($),_.features.push({type:"Feature",properties:$,geometry:f.features.find(I=>i==I.properties.id).geometry})}return _}function c(_){s=_,r(0,s)}function d(_){o=_,r(1,o)}return r(2,l=v()),[s,o,l,w,c,d]}class be extends D{constructor(e){super(),K(this,e,ye,de,Q,{})}}function H(n){let e,r;return e=new be({}),{c(){j(e.$$.fragment)},m(t,s){L(e,t,s),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){G(e,t)}}}function he(n){let e,r,t,s,o,l,w,v,c,d,_,f,y,i;s=new oe({});function u(a){n[5](a)}let $={};n[1]!==void 0&&($.settings=n[1]),l=new _e({props:$}),W.push(()=>A(l,"settings",u));function I(a){n[6](a)}let B={settings:n[1]};n[0]!==void 0&&(B.imported=n[0]),c=new ie({props:B}),W.push(()=>A(c,"imported",I)),f=new le({props:{imported:n[0]}});let g=n[3]&&H();return{c(){e=O("div"),r=O("h1"),r.textContent="osm2streets route profile tool",t=N(),j(s.$$.fragment),o=N(),j(l.$$.fragment),v=N(),j(c.$$.fragment),_=N(),j(f.$$.fragment),y=N(),g&&g.c(),P(e,"slot","left")},m(a,S){b(a,e,S),J(e,r),J(e,t),L(s,e,null),J(e,o),L(l,e,null),J(e,v),L(c,e,null),J(e,_),L(f,e,null),J(e,y),g&&g.m(e,null),i=!0},p(a,S){const C={};!w&&S&2&&(w=!0,C.settings=a[1],T(()=>w=!1)),l.$set(C);const p={};S&2&&(p.settings=a[1]),!d&&S&1&&(d=!0,p.imported=a[0],T(()=>d=!1)),c.$set(p);const m={};S&1&&(m.imported=a[0]),f.$set(m),a[3]?g?S&8&&k(g,1):(g=H(),g.c(),k(g,1),g.m(e,null)):g&&(x(),F(g,1,1,()=>{g=null}),ee())},i(a){i||(k(s.$$.fragment,a),k(l.$$.fragment,a),k(c.$$.fragment,a),k(f.$$.fragment,a),k(g),i=!0)},o(a){F(s.$$.fragment,a),F(l.$$.fragment,a),F(c.$$.fragment,a),F(f.$$.fragment,a),F(g),i=!1},d(a){a&&h(e),G(s),G(l),G(c),G(f),g&&g.d()}}}function we(n){let e,r,t,s;return e=new fe({}),e.$on("polygon",n[4]),t=new me({props:{layers:n[2]}}),{c(){j(e.$$.fragment),r=N(),j(t.$$.fragment)},m(o,l){L(e,o,l),b(o,r,l),L(t,o,l),s=!0},p(o,l){const w={};l&4&&(w.layers=o[2]),t.$set(w)},i(o){s||(k(e.$$.fragment,o),k(t.$$.fragment,o),s=!0)},o(o){F(e.$$.fragment,o),F(t.$$.fragment,o),s=!1},d(o){o&&h(r),G(e,o),G(t,o)}}}function ke(n){let e,r,t;return r=new ae({props:{$$slots:{default:[we]},$$scope:{ctx:n}}}),{c(){e=O("div"),j(r.$$.fragment),P(e,"slot","main")},m(s,o){b(s,e,o),L(r,e,null),t=!0},p(s,o){const l={};o&135&&(l.$$scope={dirty:o,ctx:s}),r.$set(l)},i(s){t||(k(r.$$.fragment,s),t=!0)},o(s){F(r.$$.fragment,s),t=!1},d(s){s&&h(e),G(r)}}}function ve(n){let e,r;return e=new Y({props:{$$slots:{main:[ke],left:[he]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment)},m(t,s){L(e,t,s),r=!0},p(t,[s]){const o={};s&143&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){G(e,t)}}}function Se(n,e,r){let t;U(n,q,d=>r(3,t=d));let s={kind:"nothing"},o,l=[];Z(async()=>{await pe()});const w=d=>ue(d,s,o);function v(d){o=d,r(1,o)}function c(d){s=d,r(0,s)}return n.$$.update=()=>{n.$$.dirty&1&&s.kind=="done"&&(q.set(s.network),se.set(s.boundaryGJ),r(2,l=ne(s.network,s.boundaryGJ)))},[s,o,l,t,w,v,c]}class Fe extends D{constructor(e){super(),K(this,e,Se,ve,Q,{})}}new Fe({target:document.getElementById("app")});

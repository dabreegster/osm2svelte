import{S as D,i as K,s as Q,j as z,k as T,o as L,n as F,e as V,v as G,a as d,y as A,t as S,b as J,d as g,z as M,F as U,l as k,E as X,m as N,p as j,r as w,x as R,L as Y,I as Z,g as x,c as ee}from"./OverpassSelector-a1b80286.js";import{g as te,n as B,h as E,j as re,b as ne,d as se,A as oe,I as le,M as ie,i as ae,L as ue}from"./ImportControls-fddb5cd0.js";function pe(s){const e=s.slice(),r=e[0]||e[1];return e[8]=r,e}function fe(s){let e;return{c(){e=k("p"),e.textContent="Hover on a road to see its details"},m(r,t){d(r,e,t)},p:X,d(r){r&&g(e)}}}function q(s){let e,r,t,n,i=s[8].properties.osm_id+"",c,h,y,b,v,u=s[8].properties.weight+"",$,p,o,a,l,f=JSON.stringify(JSON.parse(s[8].properties.osm_tags),null,"  ")+"",O,I,C,P=JSON.stringify(JSON.parse(s[8].properties.lane_specs_ltr),null,"  ")+"",W;return{c(){e=k("br"),r=F(),t=k("a"),n=N("Open OSM way "),c=N(i),y=F(),b=k("br"),v=N(`
  Weight: `),$=N(u),p=F(),o=k("br"),a=N(`
  Tags:
  `),l=k("pre"),O=N(f),I=N(`
  Lanes:
  `),C=k("pre"),W=N(P),j(t,"href",h=`http://openstreetmap.org/way/${s[8].properties.osm_id}`),j(t,"target","_blank"),j(t,"rel","noreferrer"),j(l,"class","svelte-y0uczf"),j(C,"class","svelte-y0uczf")},m(_,m){d(_,e,m),d(_,r,m),d(_,t,m),w(t,n),w(t,c),d(_,y,m),d(_,b,m),d(_,v,m),d(_,$,m),d(_,p,m),d(_,o,m),d(_,a,m),d(_,l,m),w(l,O),d(_,I,m),d(_,C,m),w(C,W)},p(_,m){m&3&&i!==(i=_[8].properties.osm_id+"")&&R(c,i),m&3&&h!==(h=`http://openstreetmap.org/way/${_[8].properties.osm_id}`)&&j(t,"href",h),m&3&&u!==(u=_[8].properties.weight+"")&&R($,u),m&3&&f!==(f=JSON.stringify(JSON.parse(_[8].properties.osm_tags),null,"  ")+"")&&R(O,f),m&3&&P!==(P=JSON.stringify(JSON.parse(_[8].properties.lane_specs_ltr),null,"  ")+"")&&R(W,P)},d(_){_&&(g(e),g(r),g(t),g(y),g(b),g(v),g($),g(p),g(o),g(a),g(l),g(I),g(C))}}}function _e(s){let e,r,t,n,i,c;function h(o){s[4](o)}function y(o){s[5](o)}let b={source:"road-weights",gj:s[2],layerStyle:s[3],interactive:!0};s[0]!==void 0&&(b.clickedFeature=s[0]),s[1]!==void 0&&(b.hoveredFeature=s[1]),e=new te({props:b}),z.push(()=>T(e,"clickedFeature",h)),z.push(()=>T(e,"hoveredFeature",y));function v(o,a){return o[0]||o[1]?q:fe}function u(o,a){return a===q?pe(o):o}let $=v(s),p=$(u(s,$));return{c(){L(e.$$.fragment),n=F(),p.c(),i=V()},m(o,a){G(e,o,a),d(o,n,a),p.m(o,a),d(o,i,a),c=!0},p(o,[a]){const l={};a&4&&(l.gj=o[2]),!r&&a&1&&(r=!0,l.clickedFeature=o[0],A(()=>r=!1)),!t&&a&2&&(t=!0,l.hoveredFeature=o[1],A(()=>t=!1)),e.$set(l),$===($=v(o))&&p?p.p(u(o,$),a):(p.d(1),p=$(u(o,$)),p&&(p.c(),p.m(i.parentNode,i)))},i(o){c||(S(e.$$.fragment,o),c=!0)},o(o){J(e.$$.fragment,o),c=!1},d(o){o&&(g(n),g(i)),M(e,o),p.d(o)}}}function ce(s){return s.highway_type=="primary"?.8:.3}function me(s,e,r){let t;U(s,B,u=>r(6,t=u));let n,i,c=E(),h={type:"fill",paint:{"fill-color":["interpolate",["linear"],["get","weight"],0,"blue",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],"fill-opacity":re("hover",.8,.4)}};function y(){let u=E();if(!t)return u;let $=JSON.parse(t.toGeojsonPlain()),p=JSON.parse(t.toJson());for(let[o,a]of p.roads){let l={highway_type:a.highway_type,lane_specs_ltr:a.lane_specs_ltr,osm_id:void 0,osm_tags:{},weight:0};a.osm_ids.length==1&&(l.osm_id=a.osm_ids[0],l.osm_tags=JSON.parse(t.getOsmTagsForWay(BigInt(l.osm_id)))),l.weight=ce(l),u.features.push({type:"Feature",properties:l,geometry:$.features.find(f=>o==f.properties.id).geometry})}return u}function b(u){n=u,r(0,n)}function v(u){i=u,r(1,i)}return r(2,c=y()),[n,i,c,h,b,v]}class de extends D{constructor(e){super(),K(this,e,me,_e,Q,{})}}function H(s){let e,r;return e=new de({}),{c(){L(e.$$.fragment)},m(t,n){G(e,t,n),r=!0},i(t){r||(S(e.$$.fragment,t),r=!0)},o(t){J(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ge(s){let e,r,t,n,i,c,h,y,b,v,u,$,p;n=new oe({});function o(f){s[3](f)}let a={};s[0]!==void 0&&(a.imported=s[0]),y=new le({props:a}),z.push(()=>T(y,"imported",o));let l=s[2]&&H();return{c(){e=k("div"),r=k("h1"),r.textContent="osm2streets route profile tool",t=F(),L(n.$$.fragment),i=F(),c=k("hr"),h=F(),L(y.$$.fragment),v=F(),u=k("hr"),$=F(),l&&l.c(),j(e,"slot","left")},m(f,O){d(f,e,O),w(e,r),w(e,t),G(n,e,null),w(e,i),w(e,c),w(e,h),G(y,e,null),w(e,v),w(e,u),w(e,$),l&&l.m(e,null),p=!0},p(f,O){const I={};!b&&O&1&&(b=!0,I.imported=f[0],A(()=>b=!1)),y.$set(I),f[2]?l?O&4&&S(l,1):(l=H(),l.c(),S(l,1),l.m(e,null)):l&&(x(),J(l,1,1,()=>{l=null}),ee())},i(f){p||(S(n.$$.fragment,f),S(y.$$.fragment,f),S(l),p=!0)},o(f){J(n.$$.fragment,f),J(y.$$.fragment,f),J(l),p=!1},d(f){f&&g(e),M(n),M(y),l&&l.d()}}}function $e(s){let e,r;return e=new ue({props:{layers:s[1]}}),{c(){L(e.$$.fragment)},m(t,n){G(e,t,n),r=!0},p(t,n){const i={};n&2&&(i.layers=t[1]),e.$set(i)},i(t){r||(S(e.$$.fragment,t),r=!0)},o(t){J(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ye(s){let e,r,t;return r=new ie({props:{$$slots:{default:[$e]},$$scope:{ctx:s}}}),{c(){e=k("div"),L(r.$$.fragment),j(e,"slot","main")},m(n,i){d(n,e,i),G(r,e,null),t=!0},p(n,i){const c={};i&18&&(c.$$scope={dirty:i,ctx:n}),r.$set(c)},i(n){t||(S(r.$$.fragment,n),t=!0)},o(n){J(r.$$.fragment,n),t=!1},d(n){n&&g(e),M(r)}}}function he(s){let e,r;return e=new Y({props:{$$slots:{main:[ye],left:[ge]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},m(t,n){G(e,t,n),r=!0},p(t,[n]){const i={};n&23&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){r||(S(e.$$.fragment,t),r=!0)},o(t){J(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function be(s,e,r){let t;U(s,B,h=>r(2,t=h));let n={kind:"nothing"},i=[];Z(async()=>{await ae()});function c(h){n=h,r(0,n)}return s.$$.update=()=>{s.$$.dirty&1&&n.kind=="done"&&(B.set(n.network),ne.set(n.boundaryGJ),r(1,i=se(n.network,n.boundaryGJ)))},[n,i,t,c]}class we extends D{constructor(e){super(),K(this,e,be,he,Q,{})}}new we({target:document.getElementById("app")});

import{S as D,i as K,s as Q,j as z,k as T,o as N,n as O,e as V,v as j,a as m,y as A,t as k,b as v,d,z as L,F as U,l as w,E as X,m as S,p as F,r as J,x as C,L as Y,I as Z,g as x,c as ee}from"./OverpassSelector-56b33c1b.js";import{g as te,n as B,h as E,j as re,b as ne,d as se,A as oe,I as le,M as ie,i as ae,L as ue}from"./ImportControls-199be6c9.js";function pe(s){const e=s.slice(),r=e[0]||e[1];return e[8]=r,e}function fe(s){let e;return{c(){e=w("p"),e.textContent="Hover on a road to see its details"},m(r,t){m(r,e,t)},p:X,d(r){r&&d(e)}}}function q(s){let e,r,t,n,i=s[8].properties.osm_id+"",u,$,b,y,h,f=s[8].properties.weight+"",l,a,o,p,g,G=JSON.stringify(JSON.parse(s[8].properties.osm_tags),null,"  ")+"",P,R,M,I=JSON.stringify(JSON.parse(s[8].properties.lane_specs_ltr),null,"  ")+"",W;return{c(){e=w("br"),r=O(),t=w("a"),n=S("Open OSM way "),u=S(i),b=O(),y=w("br"),h=S(`
  Weight: `),l=S(f),a=O(),o=w("br"),p=S(`
  Tags:
  `),g=w("pre"),P=S(G),R=S(`
  Lanes:
  `),M=w("pre"),W=S(I),F(t,"href",$=`http://openstreetmap.org/way/${s[8].properties.osm_id}`),F(t,"target","_blank"),F(t,"rel","noreferrer"),F(g,"class","svelte-y0uczf"),F(M,"class","svelte-y0uczf")},m(_,c){m(_,e,c),m(_,r,c),m(_,t,c),J(t,n),J(t,u),m(_,b,c),m(_,y,c),m(_,h,c),m(_,l,c),m(_,a,c),m(_,o,c),m(_,p,c),m(_,g,c),J(g,P),m(_,R,c),m(_,M,c),J(M,W)},p(_,c){c&3&&i!==(i=_[8].properties.osm_id+"")&&C(u,i),c&3&&$!==($=`http://openstreetmap.org/way/${_[8].properties.osm_id}`)&&F(t,"href",$),c&3&&f!==(f=_[8].properties.weight+"")&&C(l,f),c&3&&G!==(G=JSON.stringify(JSON.parse(_[8].properties.osm_tags),null,"  ")+"")&&C(P,G),c&3&&I!==(I=JSON.stringify(JSON.parse(_[8].properties.lane_specs_ltr),null,"  ")+"")&&C(W,I)},d(_){_&&(d(e),d(r),d(t),d(b),d(y),d(h),d(l),d(a),d(o),d(p),d(g),d(R),d(M))}}}function _e(s){let e,r,t,n,i,u;function $(o){s[4](o)}function b(o){s[5](o)}let y={source:"road-weights",gj:s[2],layerStyle:s[3],interactive:!0};s[0]!==void 0&&(y.clickedFeature=s[0]),s[1]!==void 0&&(y.hoveredFeature=s[1]),e=new te({props:y}),z.push(()=>T(e,"clickedFeature",$)),z.push(()=>T(e,"hoveredFeature",b));function h(o,p){return o[0]||o[1]?q:fe}function f(o,p){return p===q?pe(o):o}let l=h(s),a=l(f(s,l));return{c(){N(e.$$.fragment),n=O(),a.c(),i=V()},m(o,p){j(e,o,p),m(o,n,p),a.m(o,p),m(o,i,p),u=!0},p(o,[p]){const g={};p&4&&(g.gj=o[2]),!r&&p&1&&(r=!0,g.clickedFeature=o[0],A(()=>r=!1)),!t&&p&2&&(t=!0,g.hoveredFeature=o[1],A(()=>t=!1)),e.$set(g),l===(l=h(o))&&a?a.p(f(o,l),p):(a.d(1),a=l(f(o,l)),a&&(a.c(),a.m(i.parentNode,i)))},i(o){u||(k(e.$$.fragment,o),u=!0)},o(o){v(e.$$.fragment,o),u=!1},d(o){o&&(d(n),d(i)),L(e,o),a.d(o)}}}function ce(s){return s.highway_type=="primary"?.8:.3}function me(s,e,r){let t;U(s,B,f=>r(6,t=f));let n,i,u=E(),$={type:"fill",paint:{"fill-color":["interpolate",["linear"],["get","weight"],0,"blue",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],"fill-opacity":re("hover",.8,.4)}};function b(){let f=E();if(!t)return f;let l=JSON.parse(t.toGeojsonPlain()),a=JSON.parse(t.toJson());for(let[o,p]of a.roads){let g={highway_type:p.highway_type,lane_specs_ltr:p.lane_specs_ltr,osm_id:void 0,osm_tags:{},weight:0};p.osm_ids.length==1&&(g.osm_id=p.osm_ids[0],g.osm_tags=JSON.parse(t.getOsmTagsForWay(BigInt(g.osm_id)))),g.weight=ce(g),f.features.push({type:"Feature",properties:g,geometry:l.features.find(G=>o==G.properties.id).geometry})}return f}function y(f){n=f,r(0,n)}function h(f){i=f,r(1,i)}return r(2,u=b()),[n,i,u,$,y,h]}class de extends D{constructor(e){super(),K(this,e,me,_e,Q,{})}}function H(s){let e,r;return e=new de({}),{c(){N(e.$$.fragment)},m(t,n){j(e,t,n),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){v(e.$$.fragment,t),r=!1},d(t){L(e,t)}}}function ge(s){let e,r,t,n,i,u,$,b,y;n=new oe({});function h(a){s[3](a)}let f={};s[0]!==void 0&&(f.imported=s[0]),u=new le({props:f}),z.push(()=>T(u,"imported",h));let l=s[2]&&H();return{c(){e=w("div"),r=w("h1"),r.textContent="osm2streets route profile tool",t=O(),N(n.$$.fragment),i=O(),N(u.$$.fragment),b=O(),l&&l.c(),F(e,"slot","left")},m(a,o){m(a,e,o),J(e,r),J(e,t),j(n,e,null),J(e,i),j(u,e,null),J(e,b),l&&l.m(e,null),y=!0},p(a,o){const p={};!$&&o&1&&($=!0,p.imported=a[0],A(()=>$=!1)),u.$set(p),a[2]?l?o&4&&k(l,1):(l=H(),l.c(),k(l,1),l.m(e,null)):l&&(x(),v(l,1,1,()=>{l=null}),ee())},i(a){y||(k(n.$$.fragment,a),k(u.$$.fragment,a),k(l),y=!0)},o(a){v(n.$$.fragment,a),v(u.$$.fragment,a),v(l),y=!1},d(a){a&&d(e),L(n),L(u),l&&l.d()}}}function $e(s){let e,r;return e=new ue({props:{layers:s[1]}}),{c(){N(e.$$.fragment)},m(t,n){j(e,t,n),r=!0},p(t,n){const i={};n&2&&(i.layers=t[1]),e.$set(i)},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){v(e.$$.fragment,t),r=!1},d(t){L(e,t)}}}function ye(s){let e,r,t;return r=new ie({props:{$$slots:{default:[$e]},$$scope:{ctx:s}}}),{c(){e=w("div"),N(r.$$.fragment),F(e,"slot","main")},m(n,i){m(n,e,i),j(r,e,null),t=!0},p(n,i){const u={};i&18&&(u.$$scope={dirty:i,ctx:n}),r.$set(u)},i(n){t||(k(r.$$.fragment,n),t=!0)},o(n){v(r.$$.fragment,n),t=!1},d(n){n&&d(e),L(r)}}}function be(s){let e,r;return e=new Y({props:{$$slots:{main:[ye],left:[ge]},$$scope:{ctx:s}}}),{c(){N(e.$$.fragment)},m(t,n){j(e,t,n),r=!0},p(t,[n]){const i={};n&23&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){v(e.$$.fragment,t),r=!1},d(t){L(e,t)}}}function he(s,e,r){let t;U(s,B,$=>r(2,t=$));let n={kind:"nothing"},i=[];Z(async()=>{await ae()});function u($){n=$,r(0,n)}return s.$$.update=()=>{s.$$.dirty&1&&n.kind=="done"&&(B.set(n.network),ne.set(n.boundaryGJ),r(1,i=se(n.network,n.boundaryGJ)))},[n,i,t,u]}class we extends D{constructor(e){super(),K(this,e,he,be,Q,{})}}new we({target:document.getElementById("app")});
